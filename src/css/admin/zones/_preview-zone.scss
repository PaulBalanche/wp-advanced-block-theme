@keyframes o-toolbar-in {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.o-editor {
    .editor-styles-wrapper.block-editor-writing-flow {
        background: var(--abt-background-editor, 'white');
        padding: 0;
    }

    .is-layout-flow {
        // display: flex;
        // flex-direction: column;
        // gap: 180px;
        padding: $o-space-40 0;
        border-left: solid 1px hsla(200, 0%, 55%, 0.2);
        border-right: solid 1px hsla(200, 0%, 55%, 0.2);

        .block-editor-block-list__block {
            width: 100%;
            max-width: 100%;
        }
    }

    .o-preview-zone_loader {
        display: none;
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        background: var(--abt-background-editor, 'white') center no-repeat
            url('../../img/svg-loaders/oval.svg');
        opacity: 0.75;
    }

    .block-editor-block-list__block {
        margin: 0 !important;
        user-select: none;
        opacity: 1;
        transition: $o-transition-fast;

        /* wordpress outline */
        &::after {
            display: none !important;
        }

        /* handle grids */
        &:has(> .o-grid-container) {
            &:before {
                display: none !important;
            }

            & > .o-toolbar-container {
                pointer-events: none;

                .o-toolbar {
                    pointer-events: all;
                }
            }
        }
        .block-list-appender {
            z-index: 30;
        }

        &:before {
            content: '';
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            // background: rgba(255,255,255,0.03);
            opacity: 0;
            cursor: pointer !important;
            pointer-events: none !important;
            transition: $o-transition-fast;
            z-index: 10;
        }
        &.is-empty:before {
            opacity: 0.6;
        }
        &:hover:before,
        &.is-selected:before {
            opacity: 1;
        }

        // toolbar
        &:not(:hover):not(.is-selected):not(
                [data-type='custom/wpe-grid'].has-child-selected
            )
            > .o-toolbar-container,
        &:has(.block-editor-block-list__block:hover):not(
                [data-type='custom/wpe-grid']
            )
            > .o-toolbar-container {
            display: none !important;
        }
        // &:not(:hover):not(.is-selected):has(.wpe-block-placeholder)
        //     > .o-toolbar-container,
        // &:has(.block-editor-block-list__block:hover):has(
        //         .wpe-block-placeholder
        //     ):not([data-type='custom/wpe-slide'])
        //     > .o-toolbar-container {
        //     display: flex !important;
        // }
    }

    .is-root-container:has(.block-editor-block-list__block.is-selected) {
        .block-editor-block-list__block:not(.is-selected):not(
                .has-child-selected
            ):not(.is-selected .block-editor-block-list__block):not(
                .block-editor-block-list__block .block-editor-block-list__block
            ):not(:hover) {
            opacity: 0.1;
        }
        .has-child-selected
            .block-editor-block-list__block:not(.is-selected):not(
                .has-child-selected
            ):not(.is-selected > .block-editor-block-list__block):not(:hover) {
            opacity: 0.1;
        }
    }

    .is-root-container:has(.block-editor-block-list__block.is-pre-selected) {
        .block-editor-block-list__block:not(.is-pre-selected):not(
                .has-child-pre-selected
            ):not(.is-pre-selected .block-editor-block-list__block):not(
                .block-editor-block-list__block .block-editor-block-list__block
            ):not(:hover) {
            opacity: 0.5;
        }
        .has-child-pre-selected
            .block-editor-block-list__block:not(.is-pre-selected):not(
                .has-child-pre-selected
            ):not(.is-pre-selected > .block-editor-block-list__block):not(
                :hover
            ) {
            opacity: 0.5;
        }
    }

    .edit-post-visual-editor__content-area:has(
            .block-editor-block-list__block.is-dragging
        ) {
        .block-editor-block-list__block {
            opacity: 1 !important;

            &:before {
                opacity: 1;
                border: 1px dashed var(--wp-admin-theme-color);
            }
        }
    }

    /**
    * Toolbar
    */
    // .block-editor-block-list__block.is-selected {
    //     .o-toolbar-container {
    //         .o-toolbar {
    //             left: 100%;
    //             transform: translateX(-100%) translateY(-50%);
    //         }
    //     }
    // }
    .o-toolbar-container {
        display: block;
        align-items: center;
        position: absolute;
        width: 100%;
        height: 100%;
        z-index: 31;
        top: 0;
        left: 0;
        animation: o-toolbar-in 0.1s ease-out forwards;
        cursor: pointer;

        .o-toolbar {
            display: flex;
            align-items: center;
            gap: $o-space-30;
            padding: $o-space-20;
            border-radius: $o-border-radius;
            background: $o-main-color;
            box-shadow: $o-depth-100;
            position: absolute;
            top: 0;
            left: 50%;
            z-index: 10;
            transform: translateY(-50%) translateX(-50%);
            transition: $o-transition-default;

            &:after {
                content: ' ';
                position: absolute;
                border-style: solid;
                border-color: white transparent transparent transparent;
                top: calc(100% - 1px);
                left: 35%;
                margin-left: calc(25px * -1 / 2);
                border-width: calc(25px / 2);
                transform: skewX(-30deg);
            }

            .separator {
                width: 1px;
                height: 20px;
                background: $border300;
            }
            .title {
                font-size: 0.75em;
                font-weight: 600;
                padding-inline-end: calc($o-space-10);
                padding-inline-start: calc($o-space-10);
                color: $o-text-color;

                h2 {
                    color: $o-warn-color;
                }
            }

            .instruction {
                font-size: 0.75em;
                color: $o-text-color;
            }

            .is-primary {
                box-shadow: none;
                font-weight: 500;

                .dashicon {
                    margin-right: 4px;
                }
            }

            .components-dropdown {
                display: inline-flex;

                .components-dropdown-menu__toggle {
                    color: $o-text-color;

                    &:focus {
                        box-shadow: none;
                    }

                    &:hover {
                        background: $o-accent-color-hover;
                        color: $o-foreground-color;
                    }
                }
            }
        }
    }

    .is-reusable {
        .is-primary {
            background: $o-complementary-color;

            &:hover {
                background: $o-complementary-color-dark;
            }
        }
    }

    /**
    * Appender
    */
    .is-root-container > .wp-block.block-list-appender {
        display: none;
    }
    // .wp-block.block-list-appender {
    //     background: var(--wp-admin-theme-color);
    //     border: none;
    //     width: 90%;
    //     max-width: 90%;
    //     position: relative;
    //     margin: auto;
    //     margin-top: $o-space-40;

    //     .components-button {
    //         box-shadow: none;

    //         svg {
    //             color: white;
    //             width: 30px;
    //             height: 30px;

    //             // * {
    //             //     fill: $o-accent-color;
    //             // }
    //         }
    //     }
    // }
}

#editor {
    .block-editor-block-popover__inbetween {
        display: none;
    }
    // .block-editor-block-list__insertion-point-inserter {
    //     top: calc(50% - 25px);
    //     left: calc(50% - 50px);

    //     .block-editor-inserter__toggle.components-button.has-icon {
    //         height: 50px;
    //         width: 100px;

    //         &:hover {
    //             background: white;
    //             color: var(--wp-admin-theme-color);
    //         }
    //     }
    // }
}
